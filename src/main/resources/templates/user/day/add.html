<!doctype html >
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="" xmlns:th="http://www.thymeleaf.org"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang="" xmlns:th="http://www.thymeleaf.org"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang="" xmlns:th="http://www.thymeleaf.org"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="" xmlns:th="http://www.thymeleaf.org">
<!--<![endif]-->
<head th:replace="fragments/head"></head>
<body>
    <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
    <div th:replace="fragments/nav"></div>
    <div class="container">

        <div class="row">
            <div class="col-md-8">

                <!-- SENTENCE -->
                <form th:if="${currentUser.options.get('inputType') eq 'SENTENCE'}" th:object="${form}" method="post">

                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" /> <input th:field="*{sentence}" type="text"></input> <select
                        th:field="*{sentenceStatus}">
                        <option value="POSITIVE">POSITIVE</option>
                        <option value="NEUTRAL">NEUTRAL</option>
                        <option value="NEGATIVE">NEGATIVE</option>
                    </select><br /> <br /> <input type="submit" class="btn btn-success" value="Submit" />
                </form>


                <!-- WORDS -->
                <form th:if="${currentUser.options.get('inputType') eq 'WORDS'}" th:object="${form}" method="post">
                    <div class="form-group">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    </div>
                    <div class="form-group" th:each="i : ${#numbers.sequence( 0, 5)}">
                        <label th:text="${'Word '+(i+1)}"></label>
                        <div class="row">
                            <div class="col-md-9">
                                <div style="position:relative;">
                                <input type="text" th:id="${'word'+i}" class="form-control sugesstionAutocomplete" th:name="${'words['+i+']'}"   autocomplete="off" />
                                    <div class="list-group wordList"  th:id="${'word'+i+'_list'}" style="display:none;position:absolute;z-index:10000;">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <select th:name="${'wordsStatuses['+i+']'}">
                                    <option value="POSITIVE">POSITIVE</option>
                                    <option value="NEUTRAL">NEUTRAL</option>
                                    <option value="NEGATIVE">NEGATIVE</option>
                                </select>
                            </div>
                        </div>





                    </div>
                    <script type="text/javascript">
                    // <![CDATA[
                    $(document).ready(function() {
                        $(".sugesstionAutocomplete").on("keyup", function(e) {
                            if (e.keyCode >= 46 && e.keyCode <= 90 || e.keyCode == 8) {
                            	value = $(this).val().toLowerCase();
                            	$(this).val(value);
                                $.get("/sugestions?letters=" + value , function(data) {
                                    var text = $(data, "p").text();
                                    words = JSON.parse(text);
                                    inputid = $(this).attr("id");
                                    var id = "#"+inputid+'_list';
                                    $(id).html("");
                                    var html = "";
                                	for (word in words){
                                		html += '<a href="javascript:void(0)" data-parent="'+inputid+'" class="list-group-item" >'+words[word]+'</a>';
                                	}
                                    $(id).html(html);
                                    $(id).show()
                                    $(".wordList a").click(function(){
                                    	var parent = $(this).attr("data-parent");
                                    	var word = $(this).text();
                                    	$("#"+parent).val(word);
                                    	$(this).parent().html("")
                                    	$(this).parent().hide();
                                    })	
                                }.bind(this));
                            }
                        })
                        
                      

                    })
                    // ]]>
					</script>
                    
                    <br />
                    <br /> <input type="submit" class="btn btn-success" value="Submit" />
                </form>
            </div>
            <div class="col-md-1"></div>
            <div class="col-md-3">
                <div th:replace="fragments/sidebar" />
            </div>
        </div>
        <div th:replace="fragments/footer"></div>
    </div>


</body>
</html>
